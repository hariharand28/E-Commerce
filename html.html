<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Basic Online Shop</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <style>
        :root {
            --main-bg: #fafbfc;
            --accent: #2462ff;
            --primary: #1d232a;
            --border: #dedede;
            --success: #3bb56c;
            --warn: #f2994a;
            --danger: #e74c3c;
            --radius: 8px;
        }
        * {box-sizing: border-box;}
        body {
            margin: 0;
            padding: 0;
            font-family: system-ui,Arial,sans-serif;
            background: var(--main-bg);
            color: var(--primary);
        }
        header {
            background: #fff;
            box-shadow: 0 2px 8px #0001;
            padding: 1em 1.3em;
            display: flex;
            align-items: center;
            justify-content: space-between;
            top: 0;
            position: sticky;
            z-index: 10;
        }
        header h1 {
            margin: 0;
            font-size: 1.25em;
            font-weight: 600;
            letter-spacing: 0.01em;
        }
        .cart-link {
            display: flex;
            align-items: center;
            color: var(--primary);
            text-decoration: none;
            position: relative;
            font-weight: 500;
            font-size: 1em;
        }
        .cart-badge {
            background: var(--accent);
            color: #fff;
            border-radius: 50%;
            min-width: 1.5em;
            height: 1.5em;
            font-size: 0.93em;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            margin-left: 0.5em;
        }
        main {
            max-width: 730px;
            margin: 30px auto 0;
            padding: 1.5rem 1rem;
            background: #fff;
            border-radius: var(--radius);
            box-shadow: 0 2px 8px #0001;
        }
        .products {
            display: flex;
            gap: 1.4rem;
            flex-wrap: wrap;
            justify-content: center;
            margin-bottom: 1em;
        }
        .product-card {
            flex: 1 1 210px;
            min-width: 200px;
            max-width: 260px;
            background: var(--main-bg);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            padding: 1.1em 1em 1.2em 1em;
            display: flex;
            flex-direction: column;
        }
        .product-card h2 {
            font-size: 1.1rem;
            font-weight: bold;
            margin: 0 0 0.6em 0;
        }
        .price {
            color: var(--accent);
            font-size: 1.06em;
            font-weight: 500;
            margin-bottom: 0.45em;
        }
        .desc {
            font-size: 0.98em;
            color: #444;
            margin-bottom: 0.8em;
        }
        .stock {
            font-size: 0.96em;
            font-weight: 500;
            margin-bottom: 1em;
        }
        .stock.in { color: var(--success); }
        .stock.low { color: var(--warn); }
        .stock.out { color: var(--danger); }
        .product-card button {
            margin-top: auto;
            background: var(--accent);
            color: #fff;
            border: none;
            border-radius: var(--radius);
            font-size: 1em;
            padding: 0.65em 1.1em;
            cursor: pointer;
            font-weight: 600;
            transition: background 0.18s;
        }
        .product-card button:disabled {
            background: #d4d7df;
            color: #aaa;
            cursor: not-allowed;
        }
        /* Cart Table */
        .cart-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 1.2em;
        }
        .cart-table th, .cart-table td {
            padding: 0.68em 0.5em;
            border-bottom: 1px solid var(--border);
        }
        .cart-table th {
            font-weight: 600;
            font-size: 0.97em;
            background: transparent;
            text-align: left;
        }
        .cart-table .line-total {
            font-weight: 500;
            text-align: right;
        }
        .cart-table input[type="number"] {
            width: 2.7em;
            padding: 3px 6px;
            border: 1px solid var(--border);
            border-radius: var(--radius);
            font-size: 1em;
        }
        .cart-actions button {
            background: transparent;
            color: var(--danger);
            border: none;
            cursor: pointer;
            font-size: 1.25em;
        }
        .cart-summary {
            border: 1px solid var(--border);
            background: var(--main-bg);
            border-radius: var(--radius);
            padding: 0.8em 1em;
            font-size: 1.06em;
            margin-bottom: 1.2em;
            width: 100%;
        }
        .cart-summary label {
            font-weight: 500;
        }
        .grand-total {
            font-size: 1.15em;
            font-weight: 700;
            margin-top: 0.4em;
        }
        /* Checkout Form */
        .checkout-form label {
            display: block;
            font-size: 0.98em;
            margin-bottom: 0.32em;
            font-weight: 500;
        }
        .checkout-form input,
        .checkout-form textarea {
            width: 100%;
            font-size: 1em;
            border: 1px solid var(--border);
            border-radius: var(--radius);
            margin-bottom: 1em;
            padding: 0.6em;
        }
        .checkout-form textarea {
            min-height: 62px;
            resize: vertical;
        }
        .checkout-form button {
            display: inline-block;
            background: var(--accent);
            color: #fff;
            border: none;
            border-radius: var(--radius);
            font-size: 1.07em;
            font-weight: 600;
            padding: 0.85em 1.6em;
            cursor: pointer;
        }
        .sr-only {
            position: absolute;
            left: -10000px;
            width: 1px;
            height: 1px;
            overflow: hidden;
        }
        /* Responsive */
        @media (max-width: 780px) {
            main {
                margin: 0;
                border-radius: 0;
                box-shadow: none;
            }
            .products {
                flex-direction: column;
                gap: 1em;
            }
            .product-card {
                min-width: 0;
                max-width: 100%;
            }
        }
        @media (max-width: 480px) {
            header {padding: 0.4em 0.7em;}
            main {padding: 1em 0.3em;}
        }
    </style>
</head>
<body>
    <header>
        <h1>My Online Shop</h1>
        <a href="#" class="cart-link" id="cartNav" aria-label="View cart">
            <svg width="23" height="23" viewBox="0 0 20 20" fill="none" aria-hidden="true" style="margin-right:3px">
                <path stroke="currentColor" stroke-width="1.4" d="M6.8 16.4c.54 0 .98-.44.98-.98a.98.98 0 1 0-1.96 0c0 .54.44.98.98.98zm6.6 0c.54 0 .98-.44.98-.98a.98.98 0 1 0-1.96 0c0 .54.44.98.98.98zM4.5 5.9h10.85l-.86 7.05a1.9 1.9 0 0 1-1.87 1.64h-5.4A1.9 1.9 0 0 1 5.4 12.94L4.5 5.9z"/>
                <path stroke="currentColor" stroke-width="1.2" d="M3.9 3.9h1.1"/>
            </svg>
            <span class="cart-badge" id="cartCountNav">0</span>
        </a>
    </header>
    <main>
        <section id="catalog-section"></section>
        <section id="cart-section" style="display:none"></section>
    </main>
    <script>
        // --- Sample Products
        const PRODUCTS = [
            {
                id: 1,
                name: "Wireless Headphones",
                desc: "Bluetooth 5.0, 36h battery, lightweight and comfortable.",
                price: 49.99,
                stock: 10
            },
            {
                id: 2,
                name: "Smart Water Bottle",
                desc: "Keeps water cold for 24h. Tracks daily intake with app.",
                price: 29.99,
                stock: 2
            },
            {
                id: 3,
                name: "Mini USB-C Power Bank",
                desc: "Portable 10000mAh. Rapid charging, fits in any pocket.",
                price: 22.5,
                stock: 15
            }
        ];

        // --- State (cart: {id, qty}[] )
        let cart = [];

        const cartNav = document.getElementById('cartNav');
        const cartCountNav = document.getElementById('cartCountNav');
        const catalogSection = document.getElementById('catalog-section');
        const cartSection = document.getElementById('cart-section');

        function getProduct(id) {
            return PRODUCTS.find(p => p.id === id);
        }

        function cartQtyFor(id) {
            let item = cart.find(x=>x.id===id);
            return item ? item.qty : 0;
        }
        function updateCartCount() {
            cartCountNav.textContent = cart.reduce((sum, item) => sum+item.qty, 0);
        }

        // -------------- CATALOG RENDER --------------
        function renderCatalog() {
            let html = `
                <h2 class="sr-only">Product Catalog</h2>
                <div class="products">
            `;
            for (let prod of PRODUCTS) {
                let cartQty = cartQtyFor(prod.id);
                let available = prod.stock - cartQty;

                let stockClass = "in";
                let stockText = "In Stock";
                if (available === 0) {
                    stockClass = "out";
                    stockText = "Out of Stock";
                } else if (available < 4) {
                    stockClass = "low";
                    stockText = "Low Stock";
                }
                html += `
                  <div class="product-card">
                    <h2>${prod.name}</h2>
                    <div class="price">$${prod.price.toFixed(2)}</div>
                    <div class="desc">${prod.desc}</div>
                    <div class="stock ${stockClass}">${stockText}</div>
                    <button 
                        onclick="addToCart(${prod.id})" 
                        ${available === 0 ? 'disabled' : ''}
                    >Add to Cart</button>
                  </div>
                `;
            }
            html += '</div>';
            catalogSection.innerHTML = html;
        }

        // -------------- CART RENDER --------------
        function renderCart() {
            if (cart.length === 0) {
                cartSection.innerHTML = `
                    <h2>Your Cart</h2>
                    <p>Your cart is empty.</p>
                    <button onclick="showCatalog()" style="margin-top:1em; background:var(--accent);color:white;border:none;padding:0.7em 1.2em;border-radius:var(--radius);cursor:pointer;">Return to Shop</button>
                `;
                return;
            }
            let trRows = '';
            let subtotal = 0;
            for (let item of cart) {
                let prod = getProduct(item.id);
                let lineTotal = prod.price * item.qty;
                subtotal += lineTotal;
                trRows += `
                  <tr>
                    <td>${prod.name}</td>
                    <td>$${prod.price.toFixed(2)}</td>
                    <td>
                        <input 
                            type="number"
                            min="1"
                            max="${prod.stock}"
                            value="${item.qty}"
                            onchange="updateQty(${item.id}, this.value)"
                        >
                    </td>
                    <td class="line-total">$${lineTotal.toFixed(2)}</td>
                    <td class="cart-actions">
                        <button title="Remove from cart" onclick="removeFromCart(${item.id})">&times;</button>
                    </td>
                  </tr>
                `;
            }
            let shipping = 5;
            let grandTotal = subtotal + shipping;
            cartSection.innerHTML = `
                <h2>Shopping Cart</h2>
                <div style="overflow-x:auto;">
                <table class="cart-table">
                    <thead>
                        <tr>
                            <th>Product</th><th>Price</th><th>Qty</th><th>Subtotal</th><th></th>
                        </tr>
                    </thead>
                    <tbody>
                        ${trRows}
                    </tbody>
                </table>
                </div>
                <div class="cart-summary">
                    <div>
                        <label>Subtotal:</label>
                        <span style="float:right">$${subtotal.toFixed(2)}</span>
                    </div>
                    <div>
                        <label>Shipping:</label>
                        <span style="float:right">$${shipping.toFixed(2)}</span>
                    </div>
                    <div class="grand-total">
                        Grand Total: <span style="float:right">$${grandTotal.toFixed(2)}</span>
                    </div>
                </div>
                <form class="checkout-form" id="checkout-form" autocomplete="off" onsubmit="return placeOrder(event)">
                    <label for="fullName">Full Name</label>
                    <input required id="fullName" name="fullName" type="text" placeholder="Your full name">
                    <label for="email">Email Address</label>
                    <input required id="email" name="email" type="email" placeholder="you@email.com">
                    <label for="address">Shipping Address</label>
                    <textarea required id="address" name="address" placeholder="Address"></textarea>
                    <button type="submit">Place Order</button>
                </form>
            `;
        }

        // -------------- INTERACTIVITY + NAVIGATION --------------
        function showCatalog() {
            cartSection.style.display = "none";
            catalogSection.style.display = "";
            renderCatalog();
        }
        function showCart() {
            catalogSection.style.display = "none";
            cartSection.style.display = "";
            renderCart();
        }

        cartNav.addEventListener('click', function(e){
            e.preventDefault();
            showCart();
        });

        function addToCart(id) {
            let prod = getProduct(id);
            if (!prod || prod.stock <= 0) return;
            let entry = cart.find(x=>x.id===id);
            // Only add if remaining stock
            let inCart = entry ? entry.qty : 0;
            if (prod.stock > inCart) {
                if (!entry) {
                    cart.push({id, qty: 1});
                } else {
                    entry.qty += 1;
                }
            }
            updateCartCount();
            renderCatalog();
        }
        function removeFromCart(id) {
            cart = cart.filter(x=>x.id!==id);
            updateCartCount();
            renderCart();
        }
        function updateQty(id, qty) {
            let prod = getProduct(id);
            let citem = cart.find(x=>x.id===id);
            if (!prod || !citem) return;
            let n = Math.max(1, Math.min(prod.stock, parseInt(qty)||1));
            citem.qty = n;
            updateCartCount();
            renderCart();
        }
        function placeOrder(e) {
            e.preventDefault();
            let form = document.getElementById('checkout-form');
            let name = form.fullName.value.trim();
            let email = form.email.value.trim();
            let address = form.address.value.trim();
            if (!name || !email || !address) {
                alert("Please fill out all shipping details.");
                return false;
            }
            // Log order details
            let ordered = cart.map(ci => {
                let p = getProduct(ci.id);
                return {
                    id: p.id,
                    name: p.name,
                    price: p.price,
                    qty: ci.qty
                }
            });
            console.log("Order submitted:", {
                customer: {name, email, address},
                items: ordered,
                shipping: 5,
                total: ordered.reduce((s,x)=>s+x.qty*x.price,0)+5
            });
            // Subtract stock
            cart.forEach(ci => {
                let p = getProduct(ci.id);
                if (p) p.stock -= ci.qty;
            });
            cart = [];
            updateCartCount();
            alert("Order placed!\nThank you for shopping with us.");
            showCatalog();
            return false;
        }

        // Expose event functions for inline HTML usage:
        window.addToCart = addToCart;
        window.removeFromCart = removeFromCart;
        window.updateQty = updateQty;
        window.showCatalog = showCatalog;
        window.placeOrder = placeOrder;

        // --- INITIAL RENDER
        updateCartCount();
        showCatalog();
    </script>
</body>
</html>

